<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excelæ‰¹é‡æ“ä½œå·¥å…·ç®±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 40px 20px;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            overflow-x: auto;
            flex-wrap: wrap;
        }

        .tab {
            padding: 20px 30px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1rem;
            color: #495057;
            font-weight: 500;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .tab:hover {
            background: #e9ecef;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: white;
        }

        .tab-content {
            display: none;
            padding: 40px;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .function-section {
            margin-bottom: 30px;
        }

        .function-section h2 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .function-description {
            color: #6c757d;
            margin-bottom: 25px;
            line-height: 1.6;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            cursor: pointer;
            width: 100%;
        }

        .file-input {
            display: none;
        }

        .file-input-button {
            display: block;
            padding: 15px 20px;
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            text-align: center;
            color: #6c757d;
            transition: all 0.3s ease;
        }

        .file-input-button:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .file-input-button.has-files {
            border-color: #28a745;
            background: #f0fff4;
            color: #28a745;
        }

        .file-list {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #495057;
            max-height: 100px;
            overflow-y: auto;
        }

        .file-list-item {
            padding: 5px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            margin-top: 10px;
            color: #6c757d;
            font-size: 1.1rem;
        }

        .result-section {
            display: none;
            margin-top: 30px;
            padding: 25px;
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 10px;
            animation: slideDown 0.3s ease;
        }

        .result-section.active {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
                max-height: 0;
            }
            to {
                opacity: 1;
                transform: translateY(0);
                max-height: 200px;
            }
        }

        .result-title {
            color: #155724;
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .download-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: #28a745;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .download-link:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .error-message {
            display: none;
            margin-top: 20px;
            padding: 15px 20px;
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            color: #721c24;
            animation: shake 0.3s ease;
        }

        .error-message.active {
            display: block;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-group label {
            margin: 0;
            cursor: pointer;
            user-select: none;
        }

        .help-text {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2rem;
            }

            .tab {
                padding: 15px 20px;
                font-size: 0.9rem;
            }

            .tab-content {
                padding: 25px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ”§ Excelæ‰¹é‡æ“ä½œå·¥å…·ç®±</h1>
            <p>ä¸“ä¸ºéæŠ€æœ¯äººå‘˜è®¾è®¡çš„ç®€å•æ˜“ç”¨Excelæ–‡ä»¶å¤„ç†å·¥å…·</p>
        </header>

        <div class="tabs">
            <button class="tab active" data-tab="merge-files">ğŸ“ åˆå¹¶æ–‡ä»¶</button>
            <button class="tab" data-tab="merge-sheets">ğŸ“Š åˆå¹¶Sheet</button>
            <button class="tab" data-tab="split-column">âœ‚ï¸ æŒ‰åˆ—æ‹†åˆ†</button>
            <button class="tab" data-tab="split-rows">ğŸ“„ æŒ‰è¡Œæ‹†åˆ†</button>
            <button class="tab" data-tab="find-replace">ğŸ” æŸ¥æ‰¾æ›¿æ¢</button>
            <button class="tab" data-tab="delete-columns">ğŸ—‘ï¸ åˆ é™¤åˆ—</button>
            <button class="tab" data-tab="filter-data">ğŸ¯ æ•°æ®ç­›é€‰</button>
            <button class="tab" data-tab="convert-format">ğŸ”„ æ ¼å¼è½¬æ¢</button>
        </div>

        <!-- åˆå¹¶æ–‡ä»¶ -->
        <div class="tab-content active" id="merge-files">
            <div class="function-section">
                <h2>åˆå¹¶å¤šä¸ªExcelæ–‡ä»¶</h2>
                <div class="function-description">
                    å°†å¤šä¸ªç»“æ„ç›¸åŒçš„Excelæ–‡ä»¶çºµå‘åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶ã€‚é€‚ç”¨äºæœˆåº¦æŠ¥å‘Šã€éƒ¨é—¨æ•°æ®æ±‡æ€»ç­‰åœºæ™¯ã€‚
                </div>

                <form id="merge-files-form">
                    <div class="form-group">
                        <label>é€‰æ‹©Excelæ–‡ä»¶ï¼ˆå¯å¤šé€‰ï¼‰ï¼š</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="merge-files-input" class="file-input" multiple accept=".xlsx,.xls,.csv">
                            <div class="file-input-button" id="merge-files-button">
                                ğŸ“ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„
                            </div>
                            <div class="file-list" id="merge-files-list"></div>
                        </div>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="keep-headers" checked>
                        <label for="keep-headers">ä¿ç•™æ ‡é¢˜è¡Œï¼ˆåªä¿ç•™ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„æ ‡é¢˜ï¼‰</label>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="add-source-column">
                        <label for="add-source-column">æ·»åŠ "æ¥æºæ–‡ä»¶"åˆ—</label>
                    </div>

                    <button type="submit" class="btn btn-primary">å¼€å§‹åˆå¹¶</button>
                </form>

                <div class="loading" id="merge-files-loading">
                    <div class="spinner"></div>
                    <div class="loading-text">æ­£åœ¨å¤„ç†æ–‡ä»¶ï¼Œè¯·ç¨å€™...</div>
                </div>

                <div class="result-section" id="merge-files-result">
                    <div class="result-title">âœ… å¤„ç†å®Œæˆï¼</div>
                    <div class="download-link" id="merge-files-download">
                        ğŸ“¥ ä¸‹è½½åˆå¹¶ç»“æœ
                    </div>
                </div>

                <div class="error-message" id="merge-files-error"></div>
            </div>
        </div>

        <!-- åˆå¹¶Sheet -->
        <div class="tab-content" id="merge-sheets">
            <div class="function-section">
                <h2>åˆå¹¶å•ä¸ªæ–‡ä»¶çš„å¤šä¸ªSheet</h2>
                <div class="function-description">
                    å°†ä¸€ä¸ªExcelæ–‡ä»¶ä¸­çš„æ‰€æœ‰Sheetåˆå¹¶æˆä¸€ä¸ªSheetã€‚é€‚ç”¨äºå°†æŒ‰æœˆä»½ã€éƒ¨é—¨åˆ†Sheetçš„æ•°æ®æ±‡æ€»ã€‚
                </div>

                <form id="merge-sheets-form">
                    <div class="form-group">
                        <label>é€‰æ‹©Excelæ–‡ä»¶ï¼š</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="merge-sheets-input" class="file-input" accept=".xlsx,.xls">
                            <div class="file-input-button" id="merge-sheets-button">
                                ğŸ“ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶
                            </div>
                            <div class="file-list" id="merge-sheets-list"></div>
                        </div>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="add-sheet-column">
                        <label for="add-sheet-column">æ·»åŠ "æ¥æºSheet"åˆ—</label>
                    </div>

                    <button type="submit" class="btn btn-primary">å¼€å§‹åˆå¹¶</button>
                </form>

                <div class="loading" id="merge-sheets-loading">
                    <div class="spinner"></div>
                    <div class="loading-text">æ­£åœ¨å¤„ç†æ–‡ä»¶ï¼Œè¯·ç¨å€™...</div>
                </div>

                <div class="result-section" id="merge-sheets-result">
                    <div class="result-title">âœ… å¤„ç†å®Œæˆï¼</div>
                    <div class="download-link" id="merge-sheets-download">
                        ğŸ“¥ ä¸‹è½½åˆå¹¶ç»“æœ
                    </div>
                </div>

                <div class="error-message" id="merge-sheets-error"></div>
            </div>
        </div>

        <!-- æŒ‰åˆ—æ‹†åˆ† -->
        <div class="tab-content" id="split-column">
            <div class="function-section">
                <h2>æŒ‰åˆ—æ‹†åˆ†Sheet</h2>
                <div class="function-description">
                    æ ¹æ®æŒ‡å®šåˆ—çš„å”¯ä¸€å€¼å°†æ•°æ®æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ã€‚ä¾‹å¦‚æŒ‰"éƒ¨é—¨"åˆ—æ‹†åˆ†æˆå„éƒ¨é—¨å•ç‹¬çš„æ–‡ä»¶ã€‚
                </div>

                <form id="split-column-form">
                    <div class="form-group">
                        <label>é€‰æ‹©Excelæ–‡ä»¶ï¼š</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="split-column-input" class="file-input" accept=".xlsx,.xls,.csv">
                            <div class="file-input-button" id="split-column-button">
                                ğŸ“ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶
                            </div>
                            <div class="file-list" id="split-column-list"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="split-column-name">åˆ—åï¼š</label>
                        <input type="text" id="split-column-name" class="form-control" placeholder="ä¾‹å¦‚ï¼šéƒ¨é—¨ã€åœ°åŒºã€ç±»åˆ«" required>
                        <div class="help-text">è¾“å…¥è¦æ®æ­¤æ‹†åˆ†çš„åˆ—åï¼Œè¯¥åˆ—çš„æ¯ä¸ªå”¯ä¸€å€¼å°†ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶</div>
                    </div>

                    <button type="submit" class="btn btn-primary">å¼€å§‹æ‹†åˆ†</button>
                </form>

                <div class="loading" id="split-column-loading">
                    <div class="spinner"></div>
                    <div class="loading-text">æ­£åœ¨å¤„ç†æ–‡ä»¶ï¼Œè¯·ç¨å€™...</div>
                </div>

                <div class="result-section" id="split-column-result">
                    <div class="result-title">âœ… å¤„ç†å®Œæˆï¼</div>
                    <div class="download-link" id="split-column-download">
                        ğŸ“¥ ä¸‹è½½æ‹†åˆ†ç»“æœï¼ˆZIPå‹ç¼©åŒ…ï¼‰
                    </div>
                </div>

                <div class="error-message" id="split-column-error"></div>
            </div>
        </div>

        <!-- æŒ‰è¡Œæ‹†åˆ† -->
        <div class="tab-content" id="split-rows">
            <div class="function-section">
                <h2>æŒ‰è¡Œæ•°æ‹†åˆ†Sheet</h2>
                <div class="function-description">
                    å°†å¤§æ•°æ®æ–‡ä»¶æŒ‰æŒ‡å®šè¡Œæ•°æ‹†åˆ†æˆå¤šä¸ªå°æ–‡ä»¶ã€‚é€‚ç”¨äºéœ€è¦æ§åˆ¶æ–‡ä»¶å¤§å°çš„åœºæ™¯ã€‚
                </div>

                <form id="split-rows-form">
                    <div class="form-group">
                        <label>é€‰æ‹©Excelæ–‡ä»¶ï¼š</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="split-rows-input" class="file-input" accept=".xlsx,.xls,.csv">
                            <div class="file-input-button" id="split-rows-button">
                                ğŸ“ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶
                            </div>
                            <div class="file-list" id="split-rows-list"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="rows-per-file">æ¯æ–‡ä»¶è¡Œæ•°ï¼š</label>
                        <input type="number" id="rows-per-file" class="form-control" placeholder="ä¾‹å¦‚ï¼š10000" min="1" required>
                        <div class="help-text">æ¯ä¸ªæ‹†åˆ†æ–‡ä»¶åŒ…å«çš„æœ€å¤§è¡Œæ•°</div>
                    </div>

                    <button type="submit" class="btn btn-primary">å¼€å§‹æ‹†åˆ†</button>
                </form>

                <div class="loading" id="split-rows-loading">
                    <div class="spinner"></div>
                    <div class="loading-text">æ­£åœ¨å¤„ç†æ–‡ä»¶ï¼Œè¯·ç¨å€™...</div>
                </div>

                <div class="result-section" id="split-rows-result">
                    <div class="result-title">âœ… å¤„ç†å®Œæˆï¼</div>
                    <div class="download-link" id="split-rows-download">
                        ğŸ“¥ ä¸‹è½½æ‹†åˆ†ç»“æœï¼ˆZIPå‹ç¼©åŒ…ï¼‰
                    </div>
                </div>

                <div class="error-message" id="split-rows-error"></div>
            </div>
        </div>

        <!-- æŸ¥æ‰¾æ›¿æ¢ -->
        <div class="tab-content" id="find-replace">
            <div class="function-section">
                <h2>æ‰¹é‡æŸ¥æ‰¾ä¸æ›¿æ¢</h2>
                <div class="function-description">
                    åœ¨å¤šä¸ªæ–‡ä»¶çš„æ‰€æœ‰Sheetä¸­è¿›è¡Œå…¨å±€æ–‡æœ¬æŸ¥æ‰¾å’Œæ›¿æ¢ã€‚é€‚ç”¨äºæ‰¹é‡ä¿®æ”¹æ•°æ®ã€çº é”™ç­‰åœºæ™¯ã€‚
                </div>

                <form id="find-replace-form">
                    <div class="form-group">
                        <label>é€‰æ‹©æ–‡ä»¶ï¼ˆå¯å¤šé€‰ï¼‰ï¼š</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="find-replace-input" class="file-input" multiple accept=".xlsx,.xls,.csv">
                            <div class="file-input-button" id="find-replace-button">
                                ğŸ“ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„
                            </div>
                            <div class="file-list" id="find-replace-list"></div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="find-text">æŸ¥æ‰¾å†…å®¹ï¼š</label>
                            <input type="text" id="find-text" class="form-control" placeholder="è¦æŸ¥æ‰¾çš„æ–‡æœ¬" required>
                        </div>
                        <div class="form-group">
                            <label for="replace-text">æ›¿æ¢ä¸ºï¼š</label>
                            <input type="text" id="replace-text" class="form-control" placeholder="æ›¿æ¢åçš„æ–‡æœ¬ï¼ˆå¯ä¸ºç©ºï¼‰">
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">å¼€å§‹æ›¿æ¢</button>
                </form>

                <div class="loading" id="find-replace-loading">
                    <div class="spinner"></div>
                    <div class="loading-text">æ­£åœ¨å¤„ç†æ–‡ä»¶ï¼Œè¯·ç¨å€™...</div>
                </div>

                <div class="result-section" id="find-replace-result">
                    <div class="result-title">âœ… å¤„ç†å®Œæˆï¼</div>
                    <div class="download-link" id="find-replace-download">
                        ğŸ“¥ ä¸‹è½½æ›¿æ¢ç»“æœï¼ˆZIPå‹ç¼©åŒ…ï¼‰
                    </div>
                </div>

                <div class="error-message" id="find-replace-error"></div>
            </div>
        </div>

        <!-- åˆ é™¤åˆ— -->
        <div class="tab-content" id="delete-columns">
            <div class="function-section">
                <h2>æ‰¹é‡åˆ é™¤æŒ‡å®šåˆ—</h2>
                <div class="function-description">
                    åœ¨å¤šä¸ªæ–‡ä»¶ä¸­åˆ é™¤æŒ‡å®šçš„åˆ—ã€‚é€‚ç”¨äºæ¸…ç†æ•æ„Ÿä¿¡æ¯ã€ç®€åŒ–æ•°æ®ç»“æ„ç­‰åœºæ™¯ã€‚
                </div>

                <form id="delete-columns-form">
                    <div class="form-group">
                        <label>é€‰æ‹©æ–‡ä»¶ï¼ˆå¯å¤šé€‰ï¼‰ï¼š</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="delete-columns-input" class="file-input" multiple accept=".xlsx,.xls,.csv">
                            <div class="file-input-button" id="delete-columns-button">
                                ğŸ“ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„
                            </div>
                            <div class="file-list" id="delete-columns-list"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="columns-to-delete">è¦åˆ é™¤çš„åˆ—åï¼š</label>
                        <input type="text" id="columns-to-delete" class="form-control" placeholder="ä¾‹å¦‚ï¼šå§“å,ç”µè¯ æˆ– A,C" required>
                        <div class="help-text">å¤šä¸ªåˆ—åç”¨é€—å·åˆ†éš”ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ é™¤å­˜åœ¨çš„åˆ—</div>
                    </div>

                    <button type="submit" class="btn btn-primary">å¼€å§‹åˆ é™¤</button>
                </form>

                <div class="loading" id="delete-columns-loading">
                    <div class="spinner"></div>
                    <div class="loading-text">æ­£åœ¨å¤„ç†æ–‡ä»¶ï¼Œè¯·ç¨å€™...</div>
                </div>

                <div class="result-section" id="delete-columns-result">
                    <div class="result-title">âœ… å¤„ç†å®Œæˆï¼</div>
                    <div class="download-link" id="delete-columns-download">
                        ğŸ“¥ ä¸‹è½½å¤„ç†ç»“æœï¼ˆZIPå‹ç¼©åŒ…ï¼‰
                    </div>
                </div>

                <div class="error-message" id="delete-columns-error"></div>
            </div>
        </div>

        <!-- æ•°æ®ç­›é€‰ -->
        <div class="tab-content" id="filter-data">
            <div class="function-section">
                <h2>æ‰¹é‡æ•°æ®ç­›é€‰</h2>
                <div class="function-description">
                    ä»å¤šä¸ªæ–‡ä»¶ä¸­ç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®å¹¶åˆå¹¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚æ”¯æŒæ–‡æœ¬å’Œæ•°å€¼ç­›é€‰ã€‚
                </div>

                <form id="filter-data-form">
                    <div class="form-group">
                        <label>é€‰æ‹©æ–‡ä»¶ï¼ˆå¯å¤šé€‰ï¼‰ï¼š</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="filter-data-input" class="file-input" multiple accept=".xlsx,.xls,.csv">
                            <div class="file-input-button" id="filter-data-button">
                                ğŸ“ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„
                            </div>
                            <div class="file-list" id="filter-data-list"></div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="filter-column">åˆ—åï¼š</label>
                            <input type="text" id="filter-column" class="form-control" placeholder="è¦ç­›é€‰çš„åˆ—å" required>
                        </div>
                        <div class="form-group">
                            <label for="filter-condition">æ¡ä»¶ï¼š</label>
                            <select id="filter-condition" class="form-control" required>
                                <option value="">é€‰æ‹©æ¡ä»¶</option>
                                <option value="ç­‰äº">ç­‰äº</option>
                                <option value="ä¸ç­‰äº">ä¸ç­‰äº</option>
                                <option value="åŒ…å«">åŒ…å«</option>
                                <option value="ä¸åŒ…å«">ä¸åŒ…å«</option>
                                <option value="å¤§äº">å¤§äº</option>
                                <option value="å°äº">å°äº</option>
                                <option value="å¤§äºç­‰äº">å¤§äºç­‰äº</option>
                                <option value="å°äºç­‰äº">å°äºç­‰äº</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="filter-value">å€¼ï¼š</label>
                            <input type="text" id="filter-value" class="form-control" placeholder="ç­›é€‰çš„å€¼" required>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">å¼€å§‹ç­›é€‰</button>
                </form>

                <div class="loading" id="filter-data-loading">
                    <div class="spinner"></div>
                    <div class="loading-text">æ­£åœ¨å¤„ç†æ–‡ä»¶ï¼Œè¯·ç¨å€™...</div>
                </div>

                <div class="result-section" id="filter-data-result">
                    <div class="result-title">âœ… å¤„ç†å®Œæˆï¼</div>
                    <div class="download-link" id="filter-data-download">
                        ğŸ“¥ ä¸‹è½½ç­›é€‰ç»“æœ
                    </div>
                </div>

                <div class="error-message" id="filter-data-error"></div>
            </div>
        </div>

        <!-- æ ¼å¼è½¬æ¢ -->
        <div class="tab-content" id="convert-format">
            <div class="function-section">
                <h2>æ ¼å¼è½¬æ¢ï¼ˆXLSX â†” CSVï¼‰</h2>
                <div class="function-description">
                    æ‰¹é‡è½¬æ¢Excelæ–‡ä»¶æ ¼å¼ã€‚XLSXè½¬CSVæ—¶ï¼Œæ¯ä¸ªSheetä¼šç”Ÿæˆä¸€ä¸ªç‹¬ç«‹çš„CSVæ–‡ä»¶ã€‚
                </div>

                <form id="convert-format-form">
                    <div class="form-group">
                        <label>é€‰æ‹©æ–‡ä»¶ï¼ˆå¯å¤šé€‰ï¼‰ï¼š</label>
                        <div class="file-input-wrapper">
                            <input type="file" id="convert-format-input" class="file-input" multiple accept=".xlsx,.xls,.csv">
                            <div class="file-input-button" id="convert-format-button">
                                ğŸ“ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„
                            </div>
                            <div class="file-list" id="convert-format-list"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="convert-type">è½¬æ¢ç±»å‹ï¼š</label>
                        <select id="convert-type" class="form-control" required>
                            <option value="">é€‰æ‹©è½¬æ¢ç±»å‹</option>
                            <option value="xlsx_to_csv">XLSX è½¬ CSV</option>
                            <option value="csv_to_xlsx">CSV è½¬ XLSX</option>
                        </select>
                        <div class="help-text">XLSXè½¬CSVï¼šæ¯ä¸ªSheetç”Ÿæˆä¸€ä¸ªCSVæ–‡ä»¶ï¼›CSVè½¬XLSXï¼šæ¯ä¸ªCSVç”Ÿæˆä¸€ä¸ªExcelæ–‡ä»¶</div>
                    </div>

                    <button type="submit" class="btn btn-primary">å¼€å§‹è½¬æ¢</button>
                </form>

                <div class="loading" id="convert-format-loading">
                    <div class="spinner"></div>
                    <div class="loading-text">æ­£åœ¨å¤„ç†æ–‡ä»¶ï¼Œè¯·ç¨å€™...</div>
                </div>

                <div class="result-section" id="convert-format-result">
                    <div class="result-title">âœ… å¤„ç†å®Œæˆï¼</div>
                    <div class="download-link" id="convert-format-download">
                        ğŸ“¥ ä¸‹è½½è½¬æ¢ç»“æœï¼ˆZIPå‹ç¼©åŒ…ï¼‰
                    </div>
                </div>

                <div class="error-message" id="convert-format-error"></div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let selectedFiles = {};

        // æ ‡ç­¾åˆ‡æ¢åŠŸèƒ½
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

                // æ·»åŠ å½“å‰æ´»åŠ¨çŠ¶æ€
                tab.classList.add('active');
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // æ–‡ä»¶ä¸Šä¼ å¤„ç†å‡½æ•°
        function setupFileUpload(inputId, buttonId, listId, multiple = false) {
            const input = document.getElementById(inputId);
            const button = document.getElementById(buttonId);
            const list = document.getElementById(listId);

            // ç‚¹å‡»æŒ‰é’®è§¦å‘æ–‡ä»¶é€‰æ‹©
            button.addEventListener('click', () => {
                input.click();
            });

            // æ–‡ä»¶é€‰æ‹©å¤„ç†
            input.addEventListener('change', (e) => {
                const files = Array.from(e.target.files);
                selectedFiles[inputId] = files;

                if (files.length > 0) {
                    button.classList.add('has-files');
                    button.innerHTML = `ğŸ“ å·²é€‰æ‹© ${files.length} ä¸ªæ–‡ä»¶`;

                    // æ˜¾ç¤ºæ–‡ä»¶åˆ—è¡¨
                    list.innerHTML = files.map(file =>
                        `<div class="file-list-item">ğŸ“„ ${file.name} (${formatFileSize(file.size)})</div>`
                    ).join('');
                } else {
                    button.classList.remove('has-files');
                    button.innerHTML = multiple ?
                        'ğŸ“ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„' :
                        'ğŸ“ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶';
                    list.innerHTML = '';
                }
            });

            // æ‹–æ‹½æ”¯æŒ
            if (multiple) {
                button.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    button.style.borderColor = '#667eea';
                    button.style.background = '#f0f4ff';
                });

                button.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    button.style.borderColor = '#dee2e6';
                    button.style.background = '#f8f9fa';
                });

                button.addEventListener('drop', (e) => {
                    e.preventDefault();
                    button.style.borderColor = '#dee2e6';
                    button.style.background = '#f8f9fa';

                    const files = Array.from(e.dataTransfer.files);
                    input.files = e.dataTransfer.files;

                    // è§¦å‘changeäº‹ä»¶
                    const event = new Event('change', { bubbles: true });
                    input.dispatchEvent(event);
                });
            }
        }

        // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // è¡¨å•æäº¤å¤„ç†å‡½æ•°
        function setupFormSubmit(formId, apiUrl, loadingId, resultId, downloadId, errorId, formDataBuilder = null) {
            const form = document.getElementById(formId);
            const loading = document.getElementById(loadingId);
            const result = document.getElementById(resultId);
            const download = document.getElementById(downloadId);
            const error = document.getElementById(errorId);

            form.addEventListener('submit', async (e) => {
                e.preventDefault();

                // éšè—ä¹‹å‰çš„ç»“æœå’Œé”™è¯¯
                result.classList.remove('active');
                error.classList.remove('active');

                // æ„å»ºFormData
                let formData;
                if (formDataBuilder) {
                    formData = formDataBuilder();
                } else {
                    formData = new FormData(form);
                }

                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                loading.classList.add('active');
                form.querySelector('button[type="submit"]').disabled = true;

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        body: formData
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || `HTTP error! status: ${response.status}`);
                    }

                    // è·å–æ–‡ä»¶å
                    const contentDisposition = response.headers.get('Content-Disposition');
                    let filename = 'result.xlsx';
                    if (contentDisposition) {
                        const filenameMatch = contentDisposition.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);
                        if (filenameMatch && filenameMatch[1]) {
                            filename = filenameMatch[1].replace(/['"]/g, '');
                        }
                    }

                    // åˆ›å»ºä¸‹è½½é“¾æ¥
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    download.href = url;
                    download.download = filename;

                    // æ˜¾ç¤ºç»“æœ
                    loading.classList.remove('active');
                    result.classList.add('active');

                } catch (err) {
                    loading.classList.remove('active');
                    error.textContent = `âŒ ${err.message}`;
                    error.classList.add('active');
                } finally {
                    form.querySelector('button[type="submit"]').disabled = false;
                }
            });
        }

        // åˆå§‹åŒ–æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
        setupFileUpload('merge-files-input', 'merge-files-button', 'merge-files-list', true);
        setupFileUpload('merge-sheets-input', 'merge-sheets-button', 'merge-sheets-list', false);
        setupFileUpload('split-column-input', 'split-column-button', 'split-column-list', false);
        setupFileUpload('split-rows-input', 'split-rows-button', 'split-rows-list', false);
        setupFileUpload('find-replace-input', 'find-replace-button', 'find-replace-list', true);
        setupFileUpload('delete-columns-input', 'delete-columns-button', 'delete-columns-list', true);
        setupFileUpload('filter-data-input', 'filter-data-button', 'filter-data-list', true);
        setupFileUpload('convert-format-input', 'convert-format-button', 'convert-format-list', true);

        // åˆå§‹åŒ–æ‰€æœ‰è¡¨å•æäº¤
        setupFormSubmit('merge-files-form', '/api/merge-files', 'merge-files-loading', 'merge-files-result', 'merge-files-download', 'merge-files-error');

        setupFormSubmit('merge-sheets-form', '/api/merge-sheets', 'merge-sheets-loading', 'merge-sheets-result', 'merge-sheets-download', 'merge-sheets-error');

        setupFormSubmit('split-column-form', '/api/split-by-column', 'split-column-loading', 'split-column-result', 'split-column-download', 'split-column-error');

        setupFormSubmit('split-rows-form', '/api/split-by-rows', 'split-rows-loading', 'split-rows-result', 'split-rows-download', 'split-rows-error');

        setupFormSubmit('find-replace-form', '/api/find-replace', 'find-replace-loading', 'find-replace-result', 'find-replace-download', 'find-replace-error');

        setupFormSubmit('delete-columns-form', '/api/delete-columns', 'delete-columns-loading', 'delete-columns-result', 'delete-columns-download', 'delete-columns-error');

        setupFormSubmit('filter-data-form', '/api/filter-data', 'filter-data-loading', 'filter-data-result', 'filter-data-download', 'filter-data-error');

        setupFormSubmit('convert-format-form', '/api/convert-format', 'convert-format-loading', 'convert-format-result', 'convert-format-download', 'convert-format-error');

        // é¡µé¢åŠ è½½å®Œæˆæç¤º
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Excelå·¥å…·ç®±å·²å°±ç»ªï¼');
        });
    </script>
</body>
</html>